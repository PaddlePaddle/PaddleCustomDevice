#include <cstring>
#include <string>

#define PADDLE_BUILD_ENV_VERSION_PATH "@PADDLE_BUILD_ENV_PATH@/version/__init__.py"

#define PADDLE_MINIMUM_VERSION_MAJOR @PADDLE_MINIMUM_VERSION_MAJOR@
#define PADDLE_MINIMUM_VERSION_MINOR @PADDLE_MINIMUM_VERSION_MINOR@
#define PADDLE_MINIMUM_VERSION_PATCH @PADDLE_MINIMUM_VERSION_PATCH@
#define PADDLE_MINIMUM_VERSION_TYPE "@PADDLE_MINIMUM_VERSION_TYPE@"
#define PADDLE_MINIMUM_VERSION_TYPENO @PADDLE_MINIMUM_VERSION_TYPENO@

#define RUNTIME_MINIMUM_VERSION_MAJOR @RUNTIME_MINIMUM_VERSION_MAJOR@
#define RUNTIME_MINIMUM_VERSION_MINOR @RUNTIME_MINIMUM_VERSION_MINOR@
#define RUNTIME_MINIMUM_VERSION_PATCH @RUNTIME_MINIMUM_VERSION_PATCH@
#define RUNTIME_MINIMUM_VERSION_TYPE "@RUNTIME_MINIMUM_VERSION_TYPE@"
#define RUNTIME_MINIMUM_VERSION_TYPENO @RUNTIME_MINIMUM_VERSION_TYPENO@

#define DRIVER_MINIMUM_VERSION_MAJOR @DRIVER_MINIMUM_VERSION_MAJOR@
#define DRIVER_MINIMUM_VERSION_MINOR @DRIVER_MINIMUM_VERSION_MINOR@
#define DRIVER_MINIMUM_VERSION_PATCH @DRIVER_MINIMUM_VERSION_PATCH@
#define DRIVER_MINIMUM_VERSION_TYPE "@DRIVER_MINIMUM_VERSION_TYPE@"
#define DRIVER_MINIMUM_VERSION_TYPENO @DRIVER_MINIMUM_VERSION_TYPENO@

#define TECO_DNN_MINIMUM_VERSION_MAJOR @TECO_DNN_MINIMUM_VERSION_MAJOR@
#define TECO_DNN_MINIMUM_VERSION_MINOR @TECO_DNN_MINIMUM_VERSION_MINOR@
#define TECO_DNN_MINIMUM_VERSION_PATCH @TECO_DNN_MINIMUM_VERSION_PATCH@
#define TECO_DNN_MINIMUM_VERSION_TYPE "@TECO_DNN_MINIMUM_VERSION_TYPE@"
#define TECO_DNN_MINIMUM_VERSION_TYPENO @TECO_DNN_MINIMUM_VERSION_TYPENO@

#define TECO_BLAS_MINIMUM_VERSION_MAJOR @TECO_BLAS_MINIMUM_VERSION_MAJOR@
#define TECO_BLAS_MINIMUM_VERSION_MINOR @TECO_BLAS_MINIMUM_VERSION_MINOR@
#define TECO_BLAS_MINIMUM_VERSION_PATCH @TECO_BLAS_MINIMUM_VERSION_PATCH@
#define TECO_BLAS_MINIMUM_VERSION_TYPE "@TECO_BLAS_MINIMUM_VERSION_TYPE@"
#define TECO_BLAS_MINIMUM_VERSION_TYPENO @TECO_BLAS_MINIMUM_VERSION_TYPENO@

#define TECO_CUSTOM_MINIMUM_VERSION_MAJOR @TECO_CUSTOM_MINIMUM_VERSION_MAJOR@
#define TECO_CUSTOM_MINIMUM_VERSION_MINOR @TECO_CUSTOM_MINIMUM_VERSION_MINOR@
#define TECO_CUSTOM_MINIMUM_VERSION_PATCH @TECO_CUSTOM_MINIMUM_VERSION_PATCH@
#define TECO_CUSTOM_MINIMUM_VERSION_TYPE "@TECO_CUSTOM_MINIMUM_VERSION_TYPE@"
#define TECO_CUSTOM_MINIMUM_VERSION_TYPENO @TECO_CUSTOM_MINIMUM_VERSION_TYPENO@

#define TCCL_MINIMUM_VERSION_MAJOR @TCCL_MINIMUM_VERSION_MAJOR@
#define TCCL_MINIMUM_VERSION_MINOR @TCCL_MINIMUM_VERSION_MINOR@
#define TCCL_MINIMUM_VERSION_PATCH @TCCL_MINIMUM_VERSION_PATCH@
#define TCCL_MINIMUM_VERSION_TYPE "@TCCL_MINIMUM_VERSION_TYPE@"
#define TCCL_MINIMUM_VERSION_TYPENO @TCCL_MINIMUM_VERSION_TYPENO@

#define SDPTI_MINIMUM_VERSION_MAJOR @SDPTI_MINIMUM_VERSION_MAJOR@
#define SDPTI_MINIMUM_VERSION_MINOR @SDPTI_MINIMUM_VERSION_MINOR@
#define SDPTI_MINIMUM_VERSION_PATCH @SDPTI_MINIMUM_VERSION_PATCH@
#define SDPTI_MINIMUM_VERSION_TYPE "@SDPTI_MINIMUM_VERSION_TYPE@"
#define SDPTI_MINIMUM_VERSION_TYPENO @SDPTI_MINIMUM_VERSION_TYPENO@

#define CONCAT_VERSION_SHORT(major, minor, patch) #major "." #minor "." #patch
#define CONCAT_VERSION_LONG(major, minor, patch, type, type_no) \
  #major "." #minor "." #patch type #type_no
#define GET_VERSION(major, minor, patch, type, type_no) \
  std::strcmp(type, "") == 0                            \
      ? CONCAT_VERSION_SHORT(major, minor, patch)       \
      : CONCAT_VERSION_LONG(major, minor, patch, type, type_no)

#define TYPE_VALUE(type)                \
  ((std::strcmp(type, "a") == 0)        \
       ? 3                              \
       : ((std::strcmp(type, "b") == 0) \
              ? 2                       \
              : ((std::strcmp(type, "rc") == 0) ? 1 : 0)))

#define MINIMUM_VERSION_DEFINITIONS(name)                  \
  constexpr const char* name##_MINIMUM_SUPPORTED_VERSION = \
      GET_VERSION(name##_MINIMUM_VERSION_MAJOR,            \
                  name##_MINIMUM_VERSION_MINOR,            \
                  name##_MINIMUM_VERSION_PATCH,            \
                  name##_MINIMUM_VERSION_TYPE,             \
                  name##_MINIMUM_VERSION_TYPENO);          \
  constexpr int name##_MINIMUM_SUPPORTED_VERSION_NUM =     \
      100000000 * name##_MINIMUM_VERSION_MAJOR +           \
      1000000 * name##_MINIMUM_VERSION_MINOR +             \
      10000 * name##_MINIMUM_VERSION_PATCH +               \
      100 * TYPE_VALUE(name##_MINIMUM_VERSION_TYPE) +      \
      name##_MINIMUM_VERSION_TYPENO;

MINIMUM_VERSION_DEFINITIONS(PADDLE)
MINIMUM_VERSION_DEFINITIONS(RUNTIME)
MINIMUM_VERSION_DEFINITIONS(DRIVER)
MINIMUM_VERSION_DEFINITIONS(TECO_DNN)
MINIMUM_VERSION_DEFINITIONS(TECO_BLAS)
MINIMUM_VERSION_DEFINITIONS(TECO_CUSTOM)
MINIMUM_VERSION_DEFINITIONS(TCCL)
MINIMUM_VERSION_DEFINITIONS(SDPTI)
